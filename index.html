<!doctype html>
<html lang="th">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <link rel="stylesheet" href="/style.css">
  <link href="https://cdn.jsdelivr.net/npm/flowbite@3.1.2/dist/flowbite.min.css" rel="stylesheet" />
</head>
<style>
  body,
  html {
    height: 100%;
    margin: 0;
    font-family: Arial, sans-serif;
  }

  #map {
    height: calc(100% - 70px);
  }

  .toolbar {
    font-size: 16px;
    height: 70px;
    padding: 10px;
    display: flex;
    gap: 8px;
    align-items: center;
    background: #fff;
    box-shadow: 0 1px 4px rgba(0, 0, 0, 0.12);
  }

  .btn {
    font-size: 16px;
    padding: 8px 12px;
    border-radius: 8px;
    border: 1px solid #888;
    background: #f7f7f7;
    cursor: pointer;
  }

  .btn.primary {
    background: #007bff;
    color: #fff;
    border-color: #0069d9;
  }

  .coords {
    font-size: 14px;
  }

  .flex-right {
    margin-left: auto;
    display: flex;
    gap: 6px;
  }

  .mo-mp {
    color: red;
    align-items: center;
    display: flex;
    text-align: center;
  }

  /* Basic modal styles */
  .modal {
    display: none;
    position: fixed;
    z-index: 1;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    overflow: auto;
    background-color: rgba(0, 0, 0, 0.7);
  }

  /* Modal content styles */
  .modal-content {
    background-color: #fefefe;
    margin: 15% auto;
    padding: 20px;
    border: 1px solid #888;
    width: 80%;
    max-width: 500px;
    border-radius: 8px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    animation-name: modalFadeIn;
    animation-duration: 0.4s;
  }

  /* Close button styles */
  .close-btn {
    color: #aaa;
    float: right;
    font-size: 28px;
    font-weight: bold;
    cursor: pointer;
  }

  .close-btn:hover,
  .close-btn:focus {
    color: #000;
    text-decoration: none;
  }

  /* Fade-in animation */
  @keyframes modalFadeIn {
    from {
      opacity: 0;
      transform: translateY(-50px);
    }

    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* Style the dialog element */
  dialog {
    border: 1px solid #888;
    border-radius: 8px;
    padding: 2rem;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
  }

  /* Style the native backdrop */
  dialog::backdrop {
    background-color: rgba(0, 0, 0, 0.7);
  }
</style>

<body>
  <script src="https://cdn.jsdelivr.net/npm/flowbite@3.1.2/dist/flowbite.min.js"></script>
  <div class="toolbar">
    <div class="coords" id="coords">Lat: ‚Äî , Lng: ‚Äî </div>
    <div class="mo-mp">‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏ö‡∏£‡∏¥‡πÄ‡∏ß‡∏ì‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°</div>

    <div class="flex-right">
      <button class="btn" id="copyBtn">‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏û‡∏¥‡∏Å‡∏±‡∏î</button>
      <button class="btn" id="shareBtn">‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÅ‡∏ä‡∏£‡πå</button>
      <button class="btn primary" id="sendBtn">‡∏™‡πà‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á</button>
    </div>
  </div>
  <button onclick="document.getElementById('dialogModal').showModal()">Open Dialog</button>

  <dialog id="dialogModal">
    <h2>Native Dialog Modal</h2>
    <p>This is a more modern approach to creating a modal.</p>
    <button onclick="document.getElementById('dialogModal').close()">Close</button>
  </dialog>

  <div id="map"></div>





  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script>
    const qs = (name, fallback) => new URL(location.href).searchParams.get(name) || fallback;

    const defaultLat = parseFloat(qs('lat', '16.48014010030842'));
    const defaultLng = parseFloat(qs('lng', '99.54879500429345'));
    const map = L.map('map').setView([defaultLat, defaultLng], 14);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      maxZoom: 19,
      attribution: '&copy; OpenStreetMap contributors'
    }).addTo(map);//‡πÅ‡∏°‡∏û‡πÑ‡∏î‡πâ‡πÅ‡∏Ñ‡πà Street View ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡∏≠‡∏∑‡πà‡∏ô‡∏à‡∏∞‡πÄ‡∏™‡∏µ‡∏¢‡∏ï‡∏±‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°

    const marker = L.marker([defaultLat, defaultLng], { draggable: true }).addTo(map);
    const coordsEl = document.getElementById('coords');

    function updateCoords(latlng) {
      coordsEl.textContent = `Lat: ${latlng.lat.toFixed(6)} , Lng: ${latlng.lng.toFixed(6)}`;
    }
    updateCoords(marker.getLatLng());

    marker.on('dragend', () => updateCoords(marker.getLatLng()));
    map.on('click', e => { marker.setLatLng(e.latlng); updateCoords(e.latlng); });

    document.getElementById('copyBtn').onclick = async () => {
      const ll = marker.getLatLng();
      await navigator.clipboard.writeText(`${ll.lat},${ll.lng}`);
      alert('‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏û‡∏¥‡∏Å‡∏±‡∏î‡πÅ‡∏•‡πâ‡∏ß!');
    };

    document.getElementById('shareBtn').onclick = () => {
      const ll = marker.getLatLng();
      const url = `${location.origin}${location.pathname}?lat=${ll.lat}&lng=${ll.lng}`;
      navigator.share ? navigator.share({ url }) : prompt('‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏ô‡∏µ‡πâ:', url);
    };

    document.getElementById('sendBtn').onclick = async () => {
      const ll = marker.getLatLng();
      const payload = { lat: ll.lat, lng: ll.lng, ts: new Date().toISOString() };
      console.log(payload);//‡∏™‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏•‡∏∞‡∏ï‡∏¥‡∏à‡∏π‡∏î ‡∏•‡∏≠‡∏á‡∏ï‡∏¥‡∏à‡∏π‡∏î ‡πÅ‡∏•‡∏∞‡∏ß‡∏±‡∏ô‡πÄ‡∏ß‡∏•‡∏≤

      const webhookUrl = 'https://cctv-test.cctv-bot.site/webhook-test/657c988c-3db6-4576-9c15-814bd86f96d1'; // üëà ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ

      try {
        const resp = await fetch(webhookUrl, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload)
        });
        alert(resp.ok ? '‡∏™‡πà‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢!' : '‡∏™‡πà‡∏á‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
      } catch {
        alert('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡πà‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÑ‡∏î‡πâ (‡∏≠‡∏≤‡∏à‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏û‡∏£‡∏≤‡∏∞ CORS)');
      }
    };

    // Get necessary elements
    const modal = document.getElementById("myModal");
    const openBtn = document.getElementById("openModalBtn");
    const closeBtn = document.querySelector(".close-btn");

    // Open modal function
    function openModal() {
      modal.style.display = "block";
    }

    // Close modal function
    function closeModal() {
      modal.style.display = "none";
    }

    // Event listeners
    openBtn.addEventListener("click", openModal);
    closeBtn.addEventListener("click", closeModal);

    // Close when clicking outside the modal content
    window.addEventListener("click", function (event) {
      if (event.target === modal) {
        closeModal();
      }
    });

  </script>
</body>

</html>